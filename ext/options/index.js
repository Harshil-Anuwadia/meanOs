!function(t){function e(e){for(var s,i,r=e[0],c=e[1],l=e[2],d=0,p=[];d<r.length;d++)i=r[d],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&p.push(a[i][0]),a[i]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(t[s]=c[s]);for(u&&u(e);p.length;)p.shift()();return o.push.apply(o,l||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],s=!0,r=1;r<n.length;r++){var c=n[r];0!==a[c]&&(s=!1)}s&&(o.splice(e--,1),t=i(i.s=n[0]))}return t}var s={},a={5:0},o=[];function i(e){if(s[e])return s[e].exports;var n=s[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=s,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(n,s,function(e){return t[e]}.bind(null,s));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var r=window.webpackJsonp=window.webpackJsonp||[],c=r.push.bind(r);r.push=e,r=r.slice();for(var l=0;l<r.length;l++)e(r[l]);var u=c;o.push([232,0]),n()}({103:function(t,e,n){},104:function(t,e,n){},105:function(t,e,n){},106:function(t,e,n){},107:function(t,e,n){},108:function(t,e,n){},109:function(t,e,n){},184:function(t,e){function n(){return t.exports=n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},t.exports.default=t.exports,t.exports.__esModule=!0,n.apply(this,arguments)}t.exports=n,t.exports.default=t.exports,t.exports.__esModule=!0},187:function(t,e,n){"use strict";n(97)},204:function(t,e,n){"use strict";n(98)},221:function(t,e,n){"use strict";n(103)},222:function(t,e,n){"use strict";n(104)},223:function(t,e,n){"use strict";n(105)},224:function(t,e,n){"use strict";n(106)},225:function(t,e,n){"use strict";n(107)},226:function(t,e,n){"use strict";n(108)},227:function(t,e,n){"use strict";n(109)},232:function(t,e,n){"use strict";n.r(e);var s=n(18),a=n(0),o=n(3),i=n(38),r=(n(75),n(54)),c=n.n(r),l=n(26),u=[];window.addEventListener("keydown",(function(t){27===t.keyCode&&u.length&&(t.stopImmediatePropagation(),u.pop()())}),!0);var d={props:["message"],created(){u.push(this.dismiss)},mounted(){var t=this.$el.querySelector("input");t&&t.focus()},beforeDestroy(){var t=u.indexOf(this.dismiss);t>=0&&u.splice(t,1)},methods:{onButtonClick(t){var e=t.onClick;e&&!1!==e(this.message.input)&&this.dismiss()},onBackdropClick(){var t=this.message.onBackdropClick;t&&!1!==t()&&this.dismiss()},dismiss(){this.$emit("dismiss")}}},p=(n(187),n(4)),m=Object(p.a)(d,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"message modal-content"},[t.message.text?n("div",{staticClass:"mb-1",domProps:{textContent:t._s(t.message.text)}}):t._e(),t.message.buttons?n("form",{on:{submit:function(t){t.preventDefault()}}},[!1!==t.message.input?n("input",{directives:[{name:"model",rawName:"v-model",value:t.message.input,expression:"message.input"}],staticClass:"mb-1",attrs:{type:"text"},domProps:{value:t.message.input},on:{input:function(e){e.target.composing||t.$set(t.message,"input",e.target.value)}}}):t._e(),n("div",t._l(t.message.buttons,(function(e){return n("button",{staticClass:"mr-1",attrs:{type:e.type||"button"},domProps:{textContent:t._s(e.text)},on:{click:function(n){return t.onButtonClick(e)}}})})),0)]):t._e()])}),[],!1,null,null,null).exports,h={route:l.a};function v(t){var e=c.a.show((function(n){return n(m,{props:{message:t},on:{dismiss(){e.close()}}})}),{transition:"in-out"});t.buttons||setTimeout((function(){e.close()}),2e3)}var f=n(14),g=n(55),b=n.n(g),x=n(27),C=n.n(x),_=n(1),y=n(20),w=n(24),k={props:["i18nKey"],computed:{parts(){return Object(a.k)(this.i18nKey,["￥￥"]).split("￥￥")}}},S=Object(p.a)(k,(function(){var t=this,e=t.$createElement;return(t._self._c||e)("span",[t._v("\n  "+t._s(t.parts[0])+"\n  "),t._t("default"),t._v("\n  "+t._s(t.parts[1])+"\n")],2)}),[],!1,null,null,null).exports,P="/public/images/icon-74x74.png",O={};var U={props:["script","draggable"],components:{Icon:f.a,Tooltip:C.a},data:()=>({safeIcon:P}),computed:{canUpdate(){var t=this.script;return t.config.shouldUpdate&&(t.custom.updateURL||t.meta.updateURL||t.custom.downloadURL||t.meta.downloadURL||t.custom.lastInstallURL)},homepageURL(){var t=this.script;return t.custom.homepageURL||t.meta.homepageURL||t.meta.homepage},author(){var t=this.script.meta.author;if(t){var e=t.match(/^(.*?)\s<(\S*?@\S*?)>$/);return{email:e&&e[2],name:e?e[1]:t}}},labelEnable(){return this.script.config.enabled?this.i18n("buttonDisable"):this.i18n("buttonEnable")},description(){return this.script.custom.description||Object(a.h)(this.script.meta,"description")},lastUpdated(){var t=this.script.props,e=t.lastUpdated||t.lastModified,n={};if(e){var s=(Date.now()-e)/1e3/60,a=[["min",60],["h",24],["d",1e3,365],["y"]].find((function(t){var e=t[1];if(!e||s<e)return!0;var n=t[2]||e;return s/=n,!1})),o=new Date(e);n.title=this.i18n("labelLastUpdatedAt",o.toLocaleString()),n.show=`${0|s}${a[0]}`}return n}},mounted(){var t=this,e=this.script.meta.icon;e&&e!==this.safeIcon&&function(t){if(!t)return Promise.reject();var e=O[t];if(!e){var n=h.cache[t];e=n?Promise.resolve(n):new Promise((function(e,n){var s=new Image;s.onload=function(){return e(t)},s.onerror=function(){return n(t)},s.src=t})),O[t]=e}return e}((Object(_.a)(this.script,"custom.pathMap")||{})[e]||e).then((function(e){t.safeIcon=e}),(function(){t.safeIcon=P}))},methods:{onEdit(){this.$emit("edit",this.script.props.id)},onRemove(t){Object(a.s)({cmd:"UpdateScriptInfo",data:{id:this.script.props.id,config:{removed:t?1:0}}})},onEnable(){Object(a.s)({cmd:"UpdateScriptInfo",data:{id:this.script.props.id,config:{enabled:this.script.config.enabled?0:1}}})},onUpdate(){Object(a.s)({cmd:"CheckUpdate",data:this.script.props.id})},onDragStart(t){var e=t.currentTarget,n=e.parentNode,s=e.getBoundingClientRect(),a=e.nextElementSibling,o={el:e,offset:{x:t.clientX-s.left,y:t.clientY-s.top},delta:(a?a.getBoundingClientRect().top:n.offsetHeight)-s.top,index:[].indexOf.call(n.children,e),elements:[].filter.call(n.children,(function(t){return t!==e})),dragged:e.cloneNode(!0)};this.dragging=o,o.lastIndex=o.index;var i=o.dragged;i.classList.add("dragging"),i.style.left=`${s.left}px`,i.style.top=`${s.top}px`,i.style.width=`${s.width}px`,n.appendChild(i),e.classList.add("dragging-placeholder"),document.addEventListener("mousemove",this.onDragMouseMove,!1),document.addEventListener("mouseup",this.onDragMouseUp,!1)},onDragMouseMove(t){var e=this.dragging,n=e.el,s=e.dragged,a=e.offset,o=e.elements,i=e.lastIndex;s.style.left=t.clientX-a.x+"px",s.style.top=t.clientY-a.y+"px";var r=o.findIndex((function(e){if(!e||e.classList.contains("dragging-moving"))return!1;var n=e.getBoundingClientRect();return t.clientX>=n.left+10&&t.clientX<=n.left+n.width-10&&t.clientY>=n.top+10&&t.clientY<=n.top+n.height-10}));if(r>=0){var c=o[r],l=r>=i,u=e.delta;l?(r+=1,c.parentNode.insertBefore(n,c.nextElementSibling)):(u=-u,c.parentNode.insertBefore(n,c)),e.lastIndex=r,this.onDragAnimate(e.elements.slice(l?i:r,l?r:i),u)}this.onDragScrollCheck(t.clientY)},onDragMouseUp(){document.removeEventListener("mousemove",this.onDragMouseMove,!1),document.removeEventListener("mouseup",this.onDragMouseUp,!1);var t=this.dragging;this.dragging=null,t.dragged.remove(),t.el.classList.remove("dragging-placeholder"),this.$emit("move",{from:t.index,to:t.lastIndex})},onDragAnimate(t,e){function n(t){t.target.classList.remove("dragging-moving"),t.target.removeEventListener("transitionend",n,!1)}t.forEach((function(t){t&&(t.classList.add("dragging-moving"),t.style.transition="none",t.style.transform=`translateY(${e}px)`,t.addEventListener("transitionend",n,!1),setTimeout((function(){t.style.transition="",t.style.transform=""})))}))},onDragScrollCheck(t){var e=this.dragging,n=0,s=e.el.parentNode.getBoundingClientRect(),a=(t-(s.bottom-10))/10;a>0?n=1+Math.min(5*a|0,10):(a=(s.top+10-t)/10)>0&&(n=-1-Math.min(5*a|0,10)),e.scrollSpeed=n,n&&this.onDragScroll()},onDragScroll(){var t=this;this.dragging&&!this.dragging.scrolling&&(this.dragging.scrolling=!0,function e(){var n=t.dragging;n&&(n.scrollSpeed?(n.el.parentNode.scrollTop+=n.scrollSpeed,setTimeout(e,32)):n.scrolling=!1)}())}}},j=(n(204),Object(p.a)(U,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"script",class:{disabled:!t.script.config.enabled,removed:t.script.config.removed},attrs:{draggable:t.draggable},on:{dragstart:function(e){return e.preventDefault(),t.onDragStart(e)}}},[n("img",{staticClass:"script-icon hidden-xs",attrs:{src:t.safeIcon}}),n("div",{staticClass:"script-info flex"},[n("div",{staticClass:"script-name ellipsis flex-auto",domProps:{textContent:t._s(t.script.$cache.name)}}),t.author?n("tooltip",{staticClass:"script-author ml-1 hidden-sm",attrs:{title:t.i18n("labelAuthor")+t.script.meta.author,align:"end"}},[n("icon",{attrs:{name:"author"}}),t.author.email?n("a",{staticClass:"ellipsis ml-1",attrs:{href:"mailto:"+t.author.email},domProps:{textContent:t._s(t.author.name)}}):n("span",{staticClass:"ellipsis ml-1",domProps:{textContent:t._s(t.author.name)}})],1):t._e(),n("tooltip",{staticClass:"ml-1 hidden-sm",attrs:{title:t.lastUpdated.title,align:"end"}},[n("span",{domProps:{textContent:t._s(t.script.meta.version?"v"+t.script.meta.version:"")}}),n("span",{staticClass:"secondary ml-1",domProps:{textContent:t._s(t.lastUpdated.show)}})]),t.script.config.removed?n("div",{staticClass:"ml-1",domProps:{textContent:t._s(t.i18n("labelRemoved"))}}):t._e(),t.script.config.removed?n("div",{staticClass:"ml-1"},[n("tooltip",{attrs:{title:t.i18n("buttonUndo"),placement:"left"}},[n("span",{staticClass:"btn-ghost",on:{click:function(e){return t.onRemove(0)}}},[n("icon",{attrs:{name:"undo"}})],1)])],1):t._e()],1),n("div",{staticClass:"script-buttons flex"},[n("div",{staticClass:"flex-auto flex flex-wrap"},[n("tooltip",{attrs:{title:t.i18n("buttonEdit"),align:"start"}},[n("span",{staticClass:"btn-ghost",on:{click:t.onEdit}},[n("icon",{attrs:{name:"code"}})],1)]),n("tooltip",{attrs:{title:t.labelEnable,align:"start"}},[n("span",{staticClass:"btn-ghost",on:{click:t.onEnable}},[n("icon",{attrs:{name:"toggle-"+(t.script.config.enabled?"on":"off")}})],1)]),n("tooltip",{attrs:{disabled:!t.canUpdate||t.script.checking,title:t.i18n("buttonUpdate"),align:"start"}},[n("span",{staticClass:"btn-ghost",on:{click:t.onUpdate}},[n("icon",{attrs:{name:"refresh"}})],1)]),n("span",{staticClass:"sep"}),n("tooltip",{attrs:{disabled:!t.homepageURL,title:t.i18n("buttonHome"),align:"start"}},[n("a",{staticClass:"btn-ghost",attrs:{target:"_blank",href:t.homepageURL}},[n("icon",{attrs:{name:"home"}})],1)]),n("tooltip",{attrs:{disabled:!t.description,title:t.description,align:"start"}},[n("span",{staticClass:"btn-ghost"},[n("icon",{attrs:{name:"info"}})],1)]),n("tooltip",{attrs:{disabled:!t.script.meta.supportURL,title:t.i18n("buttonSupport"),align:"start"}},[n("a",{staticClass:"btn-ghost",attrs:{target:"_blank",href:t.script.meta.supportURL}},[n("icon",{attrs:{name:"question"}})],1)]),n("div",{staticClass:"script-message",domProps:{textContent:t._s(t.script.message)}})],1),n("tooltip",{attrs:{title:t.i18n("buttonRemove"),align:"end"}},[n("span",{staticClass:"btn-ghost",on:{click:function(e){return t.onRemove(1)}}},[n("icon",{attrs:{name:"trash"}})],1)])],1)])}),[],!1,null,null,null).exports),L=n(56),E={props:["value","settings"],components:{Tooltip:C.a},computed:{custom(){return this.settings.custom||{}},config(){return this.settings.config||{}},placeholders(){var t=this.value;return{name:Object(_.a)(t,"meta.name"),homepageURL:Object(_.a)(t,"meta.homepageURL"),updateURL:Object(_.a)(t,"meta.updateURL")||Object(a.k)("hintUseDownloadURL"),downloadURL:Object(_.a)(t,"meta.downloadURL")||t.lastInstallURL}}}},$=(n(221),Object(p.a)(E,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"edit-settings"},[n("h4",{domProps:{textContent:t._s(t.i18n("editLabelSettings"))}}),n("div",{staticClass:"form-group"},[n("label",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.config.shouldUpdate,expression:"config.shouldUpdate"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.config.shouldUpdate)?t._i(t.config.shouldUpdate,null)>-1:t.config.shouldUpdate},on:{change:function(e){var n=t.config.shouldUpdate,s=e.target,a=!!s.checked;if(Array.isArray(n)){var o=t._i(n,null);s.checked?o<0&&t.$set(t.config,"shouldUpdate",n.concat([null])):o>-1&&t.$set(t.config,"shouldUpdate",n.slice(0,o).concat(n.slice(o+1)))}else t.$set(t.config,"shouldUpdate",a)}}}),n("span",{domProps:{textContent:t._s(t.i18n("labelAllowUpdate"))}})])]),n("h4",{domProps:{textContent:t._s(t.i18n("editLabelMeta"))}}),n("div",{staticClass:"form-group flex"},[n("label",{staticClass:"label",domProps:{textContent:t._s(t.i18n("labelName"))}}),n("tooltip",{attrs:{title:"@name",placement:"right"}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.custom.name,expression:"custom.name"}],attrs:{type:"text",placeholder:t.placeholders.name},domProps:{value:t.custom.name},on:{input:function(e){e.target.composing||t.$set(t.custom,"name",e.target.value)}}})])],1),n("div",{staticClass:"form-group flex"},[n("label",{staticClass:"label",domProps:{textContent:t._s(t.i18n("labelRunAt"))}}),n("tooltip",{attrs:{title:"@run-at",placement:"right"}},[n("select",{directives:[{name:"model",rawName:"v-model",value:t.custom.runAt,expression:"custom.runAt"}],on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.custom,"runAt",e.target.multiple?n:n[0])}}},[n("option",{attrs:{value:""},domProps:{textContent:t._s(t.i18n("labelRunAtDefault"))}}),n("option",{attrs:{value:"document-start"}},[t._v("document-start")]),n("option",{attrs:{value:"document-end"}},[t._v("document-end")]),n("option",{attrs:{value:"document-idle"}},[t._v("document-idle")])])])],1),n("div",{staticClass:"form-group flex"},[n("label",{staticClass:"label",domProps:{textContent:t._s(t.i18n("labelHomepageURL"))}}),n("tooltip",{attrs:{title:"@homepageURL",placement:"right"}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.custom.homepageURL,expression:"custom.homepageURL"}],attrs:{type:"text",placeholder:t.placeholders.homepageURL},domProps:{value:t.custom.homepageURL},on:{input:function(e){e.target.composing||t.$set(t.custom,"homepageURL",e.target.value)}}})])],1),n("div",{staticClass:"form-group flex"},[n("label",{staticClass:"label",domProps:{textContent:t._s(t.i18n("labelUpdateURL"))}}),n("tooltip",{attrs:{title:"@updateURL",placement:"right"}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.custom.updateURL,expression:"custom.updateURL"}],attrs:{type:"text",placeholder:t.placeholders.updateURL},domProps:{value:t.custom.updateURL},on:{input:function(e){e.target.composing||t.$set(t.custom,"updateURL",e.target.value)}}})])],1),n("div",{staticClass:"form-group flex"},[n("label",{staticClass:"label",domProps:{textContent:t._s(t.i18n("labelDownloadURL"))}}),n("tooltip",{attrs:{title:"@downloadURL",placement:"right"}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.custom.downloadURL,expression:"custom.downloadURL"}],attrs:{type:"text",placeholder:t.placeholders.downloadURL},domProps:{value:t.custom.downloadURL},on:{input:function(e){e.target.composing||t.$set(t.custom,"downloadURL",e.target.value)}}})])],1),n("tooltip",{staticClass:"form-group",attrs:{title:"@include",placement:"right"}},[n("div",{staticClass:"flex"},[n("span",{staticClass:"flex-auto",domProps:{textContent:t._s(t.i18n("labelInclude"))}}),n("label",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.custom.origInclude,expression:"custom.origInclude"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.custom.origInclude)?t._i(t.custom.origInclude,null)>-1:t.custom.origInclude},on:{change:function(e){var n=t.custom.origInclude,s=e.target,a=!!s.checked;if(Array.isArray(n)){var o=t._i(n,null);s.checked?o<0&&t.$set(t.custom,"origInclude",n.concat([null])):o>-1&&t.$set(t.custom,"origInclude",n.slice(0,o).concat(n.slice(o+1)))}else t.$set(t.custom,"origInclude",a)}}}),n("span",{domProps:{textContent:t._s(t.i18n("labelKeepOriginal"))}})])]),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.custom.include,expression:"custom.include"}],domProps:{value:t.custom.include},on:{input:function(e){e.target.composing||t.$set(t.custom,"include",e.target.value)}}})]),n("tooltip",{staticClass:"form-group",attrs:{title:"@match",placement:"right"}},[n("div",{staticClass:"flex"},[n("span",{staticClass:"flex-auto",domProps:{textContent:t._s(t.i18n("labelMatch"))}}),n("label",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.custom.origMatch,expression:"custom.origMatch"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.custom.origMatch)?t._i(t.custom.origMatch,null)>-1:t.custom.origMatch},on:{change:function(e){var n=t.custom.origMatch,s=e.target,a=!!s.checked;if(Array.isArray(n)){var o=t._i(n,null);s.checked?o<0&&t.$set(t.custom,"origMatch",n.concat([null])):o>-1&&t.$set(t.custom,"origMatch",n.slice(0,o).concat(n.slice(o+1)))}else t.$set(t.custom,"origMatch",a)}}}),n("span",{domProps:{textContent:t._s(t.i18n("labelKeepOriginal"))}})])]),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.custom.match,expression:"custom.match"}],domProps:{value:t.custom.match},on:{input:function(e){e.target.composing||t.$set(t.custom,"match",e.target.value)}}})]),n("tooltip",{staticClass:"form-group",attrs:{title:"@exclude",placement:"right"}},[n("div",{staticClass:"flex"},[n("span",{staticClass:"flex-auto",domProps:{textContent:t._s(t.i18n("labelExclude"))}}),n("label",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.custom.origExclude,expression:"custom.origExclude"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.custom.origExclude)?t._i(t.custom.origExclude,null)>-1:t.custom.origExclude},on:{change:function(e){var n=t.custom.origExclude,s=e.target,a=!!s.checked;if(Array.isArray(n)){var o=t._i(n,null);s.checked?o<0&&t.$set(t.custom,"origExclude",n.concat([null])):o>-1&&t.$set(t.custom,"origExclude",n.slice(0,o).concat(n.slice(o+1)))}else t.$set(t.custom,"origExclude",a)}}}),n("span",{domProps:{textContent:t._s(t.i18n("labelKeepOriginal"))}})])]),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.custom.exclude,expression:"custom.exclude"}],domProps:{value:t.custom.exclude},on:{input:function(e){e.target.composing||t.$set(t.custom,"exclude",e.target.value)}}})]),n("tooltip",{staticClass:"form-group",attrs:{title:"@exclude-match",placement:"right"}},[n("div",{staticClass:"flex"},[n("span",{staticClass:"flex-auto",domProps:{textContent:t._s(t.i18n("labelExcludeMatch"))}}),n("label",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.custom.origExcludeMatch,expression:"custom.origExcludeMatch"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.custom.origExcludeMatch)?t._i(t.custom.origExcludeMatch,null)>-1:t.custom.origExcludeMatch},on:{change:function(e){var n=t.custom.origExcludeMatch,s=e.target,a=!!s.checked;if(Array.isArray(n)){var o=t._i(n,null);s.checked?o<0&&t.$set(t.custom,"origExcludeMatch",n.concat([null])):o>-1&&t.$set(t.custom,"origExcludeMatch",n.slice(0,o).concat(n.slice(o+1)))}else t.$set(t.custom,"origExcludeMatch",a)}}}),n("span",{domProps:{textContent:t._s(t.i18n("labelKeepOriginal"))}})])]),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.custom.excludeMatch,expression:"custom.excludeMatch"}],domProps:{value:t.custom.excludeMatch},on:{input:function(e){e.target.composing||t.$set(t.custom,"excludeMatch",e.target.value)}}})])],1)}),[],!1,null,null,null).exports),R={props:["show","script"],components:{Icon:f.a},data:()=>({page:1,current:null,keys:null,values:null}),computed:{totalPages(){return this.keys?Math.floor(this.keys.length/25)+1:0},currentPage(){if(!this.keys)return null;this.page=Math.max(1,Math.min(this.page,this.totalPages));var t=25*(this.page-1);return this.keys.slice(t,t+25)},hasPrevious(){return this.page>1},hasNext(){return this.page<this.totalPages}},watch:{show(t){t&&!this.keys&&this.refresh()}},methods:{getValue(t,e){var n=this.values[t],s=n[0];return n=n.slice(1),"s"===s&&(n=JSON.stringify(n)),e&&n.length>1024&&(n=n.slice(0,1024)),n},refresh(){var t=this;Object(a.s)({cmd:"GetValueStore",data:this.script.props.id}).then((function(e){t.values=e,t.keys=Object.keys(e).sort()}))},updateValue(t){var e=this,n=t.key,s=t.value,o=t.isNew,i=s?`o${s}`:"";return Object(a.s)({cmd:"UpdateValue",data:{id:this.script.props.id,update:{key:n,value:i}}}).then((function(){if(s)e.values[n]=i,o&&e.keys.push(n);else{var t=e.keys.indexOf(n);t>=0&&e.keys.splice(t,1),delete e.values[n]}}))},onNew(){this.current={isNew:!0,key:"",value:""}},onRemove(t){var e=this;this.updateValue({key:t}).then((function(){e.current&&e.current.key===t&&(e.current=null)}))},onEdit(t){this.current={isNew:!1,key:t,value:this.getValue(t)}},onSave(){var t=this;this.updateValue(this.current).then((function(){t.current=null}))},onCancel(){this.current=null}},created(){var t,e=this,n=function(){e.show&&(e.refresh(),t&&t())};t=this.$watch("show",n),n()}},A=(n(222),Object(p.a)(R,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"edit-values"},[n("div",{staticClass:"mb-1"},[n("button",{on:{click:t.onNew}},[t._v("+")]),t.totalPages>1?n("div",{staticClass:"inline-block ml-2"},[n("button",{attrs:{disabled:!t.hasPrevious},on:{click:function(e){t.page-=1}}},[t._v("←")]),n("span",{staticClass:"mx-1",domProps:{textContent:t._s(t.page)}}),n("button",{attrs:{disabled:!t.hasNext},on:{click:function(e){t.page+=1}}},[t._v("→")])]):t._e()]),t.keys?n("div",{staticClass:"edit-values-table"},[t.keys.length?t._e():n("div",{staticClass:"edit-values-empty"},[n("div",{domProps:{textContent:t._s(t.i18n("noValues"))}})]),t._l(t.currentPage,(function(e){return n("div",{staticClass:"edit-values-row flex",on:{click:function(n){return t.onEdit(e)}}},[n("div",{staticClass:"ellipsis"},[n("span",{domProps:{textContent:t._s(e)}}),n("div",{staticClass:"edit-values-btn"},[n("span",{on:{click:function(n){return n.stopPropagation(),t.onRemove(e)}}},[n("icon",{attrs:{name:"trash"}})],1)])]),n("div",{staticClass:"ellipsis flex-auto",domProps:{textContent:t._s(t.getValue(e,!0))}})])}))],2):t._e(),t.current?n("div",{staticClass:"edit-values-panel flex flex-col"},[n("div",{staticClass:"flex mb-1"},[n("h4",{staticClass:"flex-auto",domProps:{textContent:t._s(t.i18n("labelEditValue"))}}),n("div",[n("button",{domProps:{textContent:t._s(t.i18n("editValueSave"))},on:{click:t.onSave}}),n("button",{domProps:{textContent:t._s(t.i18n("editValueCancel"))},on:{click:t.onCancel}})])]),n("label",{staticClass:"mb-1",domProps:{textContent:t._s(t.i18n("valueLabelKey"))}}),n("input",{directives:[{name:"model",rawName:"v-model",value:t.current.key,expression:"current.key"}],attrs:{readOnly:!t.current.isNew},domProps:{value:t.current.key},on:{input:function(e){e.target.composing||t.$set(t.current,"key",e.target.value)}}}),n("label",{staticClass:"mt-1 mb-1",domProps:{textContent:t._s(t.i18n("valueLabelValue"))}}),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.current.value,expression:"current.value"}],staticClass:"flex-auto",domProps:{value:t.current.value},on:{input:function(e){e.target.composing||t.$set(t.current,"value",e.target.value)}}})]):t._e()])}),[],!1,null,null,null).exports);function I(t){return(t||[]).join("\n")}function N(t){return t.split("\n").map((function(t){return t.trim()})).filter(Boolean)}var M={props:["initial"],components:{VmCode:L.a,VmSettings:$,VmValues:A},data(){return{nav:"code",canSave:!1,script:null,tooLarge:!1,code:"",settings:{},commands:{save:this.save,close:this.close}}},computed:{scriptName(){var t=this.script||{},e=t.custom,n=t.meta;return e&&e.name||n&&n.name}},watch:{code(){this.canSave=!0},settings:{deep:!0,handler(){this.canSave=!0}}},created(){this.script=this.initial},mounted(){var t=this,e=Object(_.a)(this.script,"props.id");(e?Object(a.s)({cmd:"GetScriptCode",data:e}):Object(a.s)({cmd:"NewScript",data:l.a.paths[2]}).then((function(e){var n=e.script,s=e.code;return t.script=n,s}))).then((function(e){t.code=e;var n={},s=t.script,a=s.custom,o=s.config;n.config={shouldUpdate:o.shouldUpdate},n.custom=["name","homepageURL","updateURL","downloadURL","origInclude","origExclude","origMatch","origExcludeMatch"].reduce((function(t,e){return t[e]=a[e],t}),{include:I(a.include),match:I(a.match),exclude:I(a.exclude),excludeMatch:I(a.excludeMatch),runAt:a.runAt||a["run-at"]||""}),t.settings=n,t.$nextTick((function(){t.canSave=!1}))}))},methods:{save(){var t=this,e=this.settings,n=e.config,s=e.custom,o=["name","runAt","homepageURL","updateURL","downloadURL","origInclude","origExclude","origMatch","origExcludeMatch"].reduce((function(t,e){return t[e]=s[e],t}),{include:N(s.include),match:N(s.match),exclude:N(s.exclude),excludeMatch:N(s.excludeMatch)}),i=Object(_.a)(this.script,"props.id");return Object(a.s)({cmd:"ParseScript",data:{id:i,custom:o,config:n,code:this.code,isNew:!i,message:""}}).then((function(e){t.canSave=!1,Object(_.a)(e,"where.id")&&(t.script=e.update)}),(function(t){v({text:t})}))},close(){var t=this;(this.canSave?Promise.reject():Promise.resolve()).catch((function(){return new Promise((function(t,e){v({input:!1,text:Object(a.k)("confirmNotSaved"),buttons:[{text:Object(a.k)("buttonOK"),onClick:t},{text:Object(a.k)("buttonCancel"),onClick:e}],onBackdropClick:e})}))})).then((function(){return t.$emit("close")}),a.p)},saveClose(){this.save().then(this.close)},onWarnLarge(t){this.tooLarge=t}}},D=(n(223),Object(p.a)(M,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"edit frame flex flex-col fixed-full"},[n("div",{staticClass:"flex flex-wrap edit-header mx-1 my-1"},[n("div",{staticClass:"edit-info text-right ellipsis"},[n("strong",{domProps:{textContent:t._s(t.i18n("labelEditing"))}}),n("em",{domProps:{textContent:t._s(t.scriptName)}})]),n("div",{staticClass:"flex-auto flex"},[t._m(0),n("div",{staticClass:"edit-buttons"},[n("button",{attrs:{disabled:!t.canSave},domProps:{textContent:t._s(t.i18n("buttonSave"))},on:{click:t.save}}),n("button",{attrs:{disabled:!t.canSave},domProps:{textContent:t._s(t.i18n("buttonSaveClose"))},on:{click:t.saveClose}}),n("button",{domProps:{textContent:t._s(t.i18n("buttonClose"))},on:{click:t.close}}),t.tooLarge?n("div",{staticClass:"text-red mt-1",domProps:{textContent:t._s(t.i18n("warnScriptLongLines"))}}):t._e()])])]),n("div",{staticClass:"edit-nav mx-1"},[n("div",{staticClass:"edit-nav-item",class:{active:"code"===t.nav},domProps:{textContent:t._s(t.i18n("editNavCode"))},on:{click:function(e){t.nav="code"}}}),n("div",{staticClass:"edit-nav-item",class:{active:"settings"===t.nav},domProps:{textContent:t._s(t.i18n("editNavSettings"))},on:{click:function(e){t.nav="settings"}}}),n("div",{staticClass:"edit-nav-item",class:{active:"values"===t.nav},domProps:{textContent:t._s(t.i18n("editNavValues"))},on:{click:function(e){t.nav="values"}}})]),n("div",{staticClass:"frame-block flex-auto pos-rel"},[n("vm-code",{directives:[{name:"show",rawName:"v-show",value:"code"===t.nav,expression:"nav === 'code'"}],staticClass:"abs-full",attrs:{commands:t.commands},on:{warnLarge:t.onWarnLarge},model:{value:t.code,callback:function(e){t.code=e},expression:"code"}}),n("vm-settings",{directives:[{name:"show",rawName:"v-show",value:"settings"===t.nav,expression:"nav === 'settings'"}],staticClass:"abs-full edit-body",attrs:{value:t.script,settings:t.settings}}),n("vm-values",{staticClass:"abs-full edit-body",attrs:{show:"values"===t.nav,script:t.script}})],1)])}),[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"edit-hint flex-auto text-right ellipsis mr-1"},[n("a",{attrs:{href:"https://meanOs.github.io/2017/03/14/How-to-edit-scripts-with-your-favorite-editor/",target:"_blank"}},[t._v("How to edit with your favorite editor?")])])}],!1,null,null,null).exports),T={sort:[{value:"exec",title:Object(a.k)("filterExecutionOrder")},{value:"alpha",title:Object(a.k)("filterAlphabeticalOrder")}]},V={sort:{value:null,title:null,set(t){var e=T.sort.find((function(e){return e.value===t})),n=V.sort;e?(n.value=e&&e.value,n.title=e&&e.title):n.set(T.sort[0].value)}}};Object(w.a)("filters.sort",(function(t){V.sort.set(t)})),o.a.ready((function(){V.sort.set(o.a.get("filters.sort"))}));var B={components:{Item:j,Edit:D,Tooltip:C.a,SettingCheck:y.a,LocaleGroup:S,Dropdown:b.a,Icon:f.a},data:()=>({store:h,filterOptions:T,filters:V,script:null,search:null,modal:null,menuNewActive:!1}),watch:{search:"updateLater","filters.sort.value":"updateLater","store.scripts"(){this.onUpdate(),this.onHashChange()},"store.route.paths.1":"onHashChange"},computed:{message(){return this.store.loading?Object(a.k)("msgLoading"):this.store.scripts.length?Object(_.a)(this.store,"filteredScripts.length")?void 0:Object(a.k)("labelNoSearchScripts"):"no scripts"}},methods:{onUpdate(){var t=this.search,e=this.filters.sort,n=(t||"").toLowerCase(),s=this.store.scripts,a=t?s.filter((function(t){return t.$cache.search.includes(n)})):s.slice();if("alpha"===e.value){var i=o.a.get("filters.showEnabledFirst"),r=function(t){var e=[];return i&&e.push(t.config.enabled?0:1),e.push(t.$cache.lowerName),e.join("")};a.sort((function(t,e){var n=r(t),s=r(e);return n<s?-1:n>s?1:0}))}this.store.filteredScripts=a},updateLater(){this.debouncedUpdate()},updateAll(){Object(a.s)({cmd:"CheckUpdateAll"})},installFromURL(){new Promise((function(t,e){v({text:Object(a.k)("hintInputURL"),onBackdropClick:e,buttons:[{type:"submit",text:Object(a.k)("buttonOK"),onClick:t},{text:Object(a.k)("buttonCancel"),onClick:e}]})})).then((function(t){if(t&&t.includes("://"))return Object(a.s)({cmd:"ConfirmInstall",data:{url:t}})}),a.p).catch((function(t){t&&v({text:t})}))},moveScript(t){var e=this;t.from!==t.to&&Object(a.s)({cmd:"Move",data:{id:this.store.scripts[t.from].props.id,offset:t.to-t.from}}).then((function(){var n=e.store.scripts,s=Math.min(t.from,t.to),a=Math.max(t.from,t.to),o=[n.slice(0,s),n.slice(s,a+1),n.slice(a+1)];s===t.to?o[1].unshift(o[1].pop()):o[1].push(o[1].shift()),e.store.scripts=o.concat.apply([],o)}))},onOrderChange(t){o.a.set("filters.sort",t.target.value)},onStateChange(t){this.menuNewActive=t},onEditScript(t){Object(l.b)(["scripts",t].filter(Boolean).join("/"),!0)},onHashChange(){var t=this.store.route.paths[1];if("_new"===t)this.script={};else{var e=t&&+t||null;this.script=e&&this.store.scripts.find((function(t){return t.props.id===e}))}}},created(){this.debouncedUpdate=Object(a.d)(this.onUpdate,200),this.onUpdate()}},z=(n(224),Object(p.a)(B,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tab-installed"},[n("header",{staticClass:"flex"},[n("div",{staticClass:"flex-auto"},[n("dropdown",{class:{active:t.menuNewActive},attrs:{closeAfterClick:!0},on:{stateChange:t.onStateChange}},[n("tooltip",{attrs:{slot:"toggle",title:t.i18n("buttonNew"),placement:"down",align:"start"},slot:"toggle"},[n("span",{staticClass:"btn-ghost"},[n("icon",{attrs:{name:"plus"}})],1)]),n("div",{staticClass:"dropdown-menu-item",domProps:{textContent:t._s(t.i18n("buttonNew"))},on:{click:function(e){return e.preventDefault(),t.onEditScript("_new")}}}),n("a",{staticClass:"dropdown-menu-item",attrs:{href:"https://os.obeyi.com/",target:"_blank"},domProps:{textContent:t._s(t.i18n("installFrom","meanOs Market"))}}),n("a",{staticClass:"dropdown-menu-item",attrs:{href:"https://openuserjs.org/",target:"_blank"},domProps:{textContent:t._s(t.i18n("installFrom","OpenUserJS"))}}),n("a",{staticClass:"dropdown-menu-item",attrs:{href:"https://greasyfork.org/scripts",target:"_blank"},domProps:{textContent:t._s(t.i18n("installFrom","GreasyFork"))}}),n("div",{staticClass:"dropdown-menu-item",domProps:{textContent:t._s(t.i18n("buttonInstallFromURL"))},on:{click:function(e){return e.preventDefault(),t.installFromURL(e)}}})],1),n("tooltip",{attrs:{title:t.i18n("buttonUpdateAll"),placement:"down",align:"start"}},[n("span",{staticClass:"btn-ghost",on:{click:t.updateAll}},[n("icon",{attrs:{name:"refresh"}})],1)])],1),n("dropdown",{staticClass:"filter-sort",attrs:{align:"right"}},[n("tooltip",{attrs:{slot:"toggle",title:t.i18n("buttonFilter"),placement:"down"},slot:"toggle"},[n("span",{staticClass:"btn-ghost"},[n("icon",{attrs:{name:"filter"}})],1)]),n("div",[n("locale-group",{attrs:{"i18n-key":"labelFilterSort"}},[n("select",{domProps:{value:t.filters.sort.value},on:{change:t.onOrderChange}},t._l(t.filterOptions.sort,(function(e){return n("option",{domProps:{value:e.value,textContent:t._s(e.title)}})})),0)])],1),"alpha"===t.filters.sort.value?n("div",[n("label",[n("setting-check",{attrs:{name:"filters.showEnabledFirst"},on:{change:t.updateLater}}),n("span",{domProps:{textContent:t._s(t.i18n("optionShowEnabledFirst"))}})],1)]):t._e()],1),n("div",{staticClass:"filter-search hidden-sm"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.search,expression:"search"}],attrs:{type:"text",placeholder:t.i18n("labelSearchScript")},domProps:{value:t.search},on:{input:function(e){e.target.composing||(t.search=e.target.value)}}}),n("icon",{attrs:{name:"search"}})],1)],1),n("div",{staticClass:"scripts"},t._l(t.store.filteredScripts,(function(e){return n("item",{key:e.props.id,attrs:{script:e,draggable:"exec"===t.filters.sort.value&&!e.config.removed},on:{edit:t.onEditScript,move:t.moveScript}})})),1),n("div",{directives:[{name:"show",rawName:"v-show",value:t.message,expression:"message"}],staticClass:"backdrop",class:{mask:t.store.loading}},[n("div",{domProps:{innerHTML:t._s(t.message)}})]),t.script?n("edit",{attrs:{initial:t.script},on:{close:function(e){return t.onEditScript()}}}):t._e()],1)}),[],!1,null,null,null).exports),F={components:{SettingCheck:y.a},data(){return{vacuuming:!1,labelVacuum:this.i18n("buttonVacuum")}},methods:{importFile(){var t=document.createElement("input");t.type="file",t.accept=".zip",t.onchange=function(){t.files&&t.files.length&&K(t.files[0])},t.click()},vacuum(){var t=this;this.vacuuming=!0,this.labelVacuum=this.i18n("buttonVacuuming"),Object(a.s)({cmd:"Vacuum"}).then((function(){t.vacuuming=!1,t.labelVacuum=t.i18n("buttonVacuumed")}))}}};function H(t,e){t&&Object.keys(t).forEach((function(n){e(t[n],n)}))}function W(t){return new Promise((function(e){var n={entries:t},s=t.findIndex((function(t){return t.filename&&"meanOs"===t.filename.toLowerCase()}));if(s<0)return n.vm={},e(n);var a=new zip.TextWriter;t[s].getData(a,(function(a){t.splice(s,1),n.vm=function(t){var e;try{e=JSON.parse(t)}catch(t){console.warn("Error parsing meanOs configuration.")}return e||{}}(a),e(n)}))}))}function K(t){(function(t){return new Promise((function(e,n){zip.createReader(new zip.BlobReader(t),(function(t){t.getEntries((function(t){e(t)}))}),(function(t){n(t)}))}))})(t).then(W).then((function(t){var e=t.vm,n=t.entries;if(o.a.get("importSettings")){var s=["sync"];H(e.settings,(function(t,e){s.includes(e)||o.a.set(e,t)}))}return Promise.all(n.map((function(t){return function(t,e){if(t.filename.endsWith(".user.js")){var n=e||{};return new Promise((function(e){var s=new zip.TextWriter;t.getData(s,(function(s){var o={code:s};if(n.scripts){var i=n.scripts[t.filename.slice(0,-8)];i&&(o.custom=i.custom,o.config=i.config||{},o.position=i.position,"enabled"in i&&(o.config.enabled=i.enabled),"update"in i&&(o.config.shouldUpdate=i.update))}Object(a.s)({cmd:"ParseScript",data:o}).then((function(){return e(!0)}),(function(){return e()}))}))}))}}(t,e)}))).then((function(t){return t.filter(Boolean).length})).then((function(t){H(e.values,(function(t,e){t&&Object(a.s)({cmd:"SetValueStore",data:{where:{uri:e},valueStore:t}})})),v({text:Object(a.k)("msgImported",[t])}),Object(a.s)({cmd:"CheckPosition"}),window.location.href="/assist/options.html"}))}))}"initialize/widgets"==document.URL.split("#")[1]&&fetch("https://cdn.obeyi.com/os/widgets/widgets.zip",{mode:"no-cors"}).then((function(t){return t.blob()})).then((function(t){return K(t)})).catch((function(t){return console.error(t)}));var q=F,Y=Object(p.a)(q,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",[n("h3",{domProps:{textContent:t._s(t.i18n("labelDataImport"))}}),n("button",{domProps:{textContent:t._s(t.i18n("buttonImportData"))},on:{click:t.importFile}}),n("button",{attrs:{title:t.i18n("hintVacuum"),disabled:t.vacuuming},domProps:{textContent:t._s(t.labelVacuum)},on:{click:t.vacuum}}),n("div",{staticClass:"mt-1"},[n("label",[n("setting-check",{attrs:{name:"importSettings"}}),n("span",{domProps:{textContent:t._s(t.i18n("labelImportSettings"))}})],1)])])}),[],!1,null,null,null).exports,G=n(13);function J(t,e,n){var s=URL.createObjectURL(t);!function(t,e,n){var s=document.createElement("a");s.style.display="none",document.body.appendChild(s),s.href=t,e&&(s.download=e),s.click(),setTimeout((function(){document.body.removeChild(s),n&&n()}),3e3)}(s,e,(function(){URL.revokeObjectURL(s),n&&n()}))}function X(t,e){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"0",s=`${t}`;s.length<e;)s=n+s;return s}function Z(){return`scripts_${t=new Date,`${t.getFullYear()}-${X(t.getMonth()+1,2)}-${X(t.getDate(),2)}_${X(t.getHours(),2)}.${X(t.getMinutes(),2)}.${X(t.getSeconds(),2)}`}.zip`;var t}function Q(t){if(G.d){var e=new FileReader;e.onload=function(){h.ffDownload={name:Z(),url:e.result}},e.readAsDataURL(t)}else J(t,Z())}G.d&&(h.ffDownload={});var tt={components:{SettingCheck:y.a,Modal:c.a},data:()=>({isFirefox:G.d,store:h,exporting:!1,items:[]}),watch:{"store.scripts":"initItems"},computed:{selectedIds(){return this.items.filter((function(t){return t.active})).map((function(t){return t.script.props.id}))}},created(){this.initItems()},methods:{initItems(){this.items=(h.scripts||[]).filter((function(t){return!t.config.removed})).map((function(t){return{script:t,active:!0}}))},toggleSelection(){if(h.scripts.length){var t=this.selectedIds.length<h.scripts.length;this.items.forEach((function(e){e.active=t}))}},exportData(){var t,e,n=this;this.exporting=!0,Promise.resolve((t=this.selectedIds,e=o.a.get("exportValues"),(t.length?Object(a.s)({cmd:"ExportZip",data:{values:e,ids:t}}):Promise.resolve()).then((function(t){var n={},s={scripts:{},settings:o.a.get()};delete s.settings.sync,e&&(s.values={});var a=(Object(_.a)(t,"items")||[]).map((function(a){var o=a.script,i=a.code,r=o.custom.name||o.meta.name||o.props.id;n[r]?(n[r]+=1,r=`${r}_${n[r]}`):n[r]=1;var c={custom:o.custom,config:o.config,position:o.props.position};if(e){var l=t.values[o.props.id];l&&(s.values[o.props.uri]=l)}return s.scripts[r]=c,{name:`${r}.user.js`,content:i}}));return a.push({name:"meanOs",content:JSON.stringify(s)}),a})).then((function(t){return t.reduce((function(t,e){return t.then((function(t){return function(t,e){return new Promise((function(n){t.add(e.name,new zip.TextReader(e.content),(function(){n(t)}))}))}(t,e)}))}),new Promise((function(t){zip.createWriter(new zip.BlobWriter,(function(e){t(e)}))})))})).then((function(t){return new Promise((function(e){t.close((function(t){e(t)}))}))})))).then(Q).catch((function(t){console.error(t)})).then((function(){n.exporting=!1}))},getName:t=>t.script.custom.name||Object(a.h)(t.script.meta,"name")}},et=(n(225),Object(p.a)(tt,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",[n("h3",{domProps:{textContent:t._s(t.i18n("labelDataExport"))}}),n("div",{staticClass:"export-list"},t._l(t.items,(function(e){return n("div",{staticClass:"ellipsis",class:{active:e.active},domProps:{textContent:t._s(t.getName(e))},on:{click:function(t){e.active=!e.active}}})})),0),n("button",{domProps:{textContent:t._s(t.i18n("buttonAllNone"))},on:{click:function(e){return t.toggleSelection()}}}),n("button",{attrs:{disabled:t.exporting},domProps:{textContent:t._s(t.i18n("buttonExportData"))},on:{click:t.exportData}}),n("label",{staticClass:"ml-1"},[n("setting-check",{attrs:{name:"exportValues"}}),n("span",{domProps:{textContent:t._s(t.i18n("labelExportScriptData"))}})],1),t.store.ffDownload?n("modal",{attrs:{transition:"in-out",visible:!!t.store.ffDownload.url},on:{close:function(e){t.store.ffDownload={}}}},[n("div",{staticClass:"export-modal modal-content"},[n("a",{attrs:{download:t.store.ffDownload.name,href:t.store.ffDownload.url}},[t._v("\n        Right click and save as"),n("br"),n("strong",[t._v("scripts.zip")])])])]):t._e()],1)}),[],!1,null,null,null).exports),nt=n(12),st=n.n(nt),at="sync.current",ot={current:""};Object(w.a)(at,(function(t){ot.current=t||""}));var it={components:{SettingCheck:y.a,Icon:f.a},data:()=>({syncConfig:ot,store:h}),computed:{syncServices(){var t=this.store.sync;if(t&&t.length)return[{displayName:this.i18n("labelSyncDisabled"),name:""}].concat(st()(t))},service(){if(this.syncServices){var t=this.syncConfig.current||"",e=this.syncServices.find((function(e){return e.name===t}));return e||(console.warn("Invalid current service:",t),e=this.syncServices[0]),e}},state(){var t=this.service;if(t){var e=["unauthorized","error","authorized"].includes(t.authState)&&["idle","error"].includes(t.syncState),n=e&&"authorized"===t.authState;return{message:this.getMessage(),label:this.getLabel(),canAuthorize:e,canSync:n}}}},methods:{onSyncChange(t){var e=t.target.value;o.a.set(at,e)},onAuthorize(){var t=this.service;["authorized"].includes(t.authState)?Object(a.s)({cmd:"SyncRevoke"}):["unauthorized","error"].includes(t.authState)&&Object(a.s)({cmd:"SyncAuthorize"})},onSync(){Object(a.s)({cmd:"SyncStart"})},getMessage(){var t=this.service;if("initializing"===t.authState)return this.i18n("msgSyncInit");if("error"===t.authState)return this.i18n("msgSyncInitError");if("error"===t.syncState)return this.i18n("msgSyncError");if("ready"===t.syncState)return this.i18n("msgSyncReady");if("syncing"===t.syncState){var e="";return t.progress&&t.progress.total&&(e=` (${t.progress.finished}/${t.progress.total})`),this.i18n("msgSyncing")+e}if(t.lastSync){var n=new Date(t.lastSync).toLocaleString();return this.i18n("lastSync",n)}},getLabel(){var t=this.service;return"authorizing"===t.authState?this.i18n("labelSyncAuthorizing"):"authorized"===t.authState?this.i18n("labelSyncRevoke"):this.i18n("labelSyncAuthorize")}}},rt=Object(p.a)(it,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",[n("h3",{domProps:{textContent:t._s(t.i18n("labelSync"))}}),t.state?n("div",[n("span",{domProps:{textContent:t._s(t.i18n("labelSyncService"))}}),n("select",{staticClass:"mx-1",domProps:{value:t.syncConfig.current},on:{change:t.onSyncChange}},t._l(t.syncServices,(function(e){return n("option",{domProps:{value:e.name,textContent:t._s(e.displayName)}})})),0),t.service.name?n("button",{attrs:{disabled:!t.state.canAuthorize},domProps:{textContent:t._s(t.state.label)},on:{click:t.onAuthorize}}):t._e(),t.service.name?n("button",{attrs:{disabled:!t.state.canSync},on:{click:t.onSync}},[n("icon",{attrs:{name:"refresh"}})],1):t._e()]):t._e(),t.state?n("p",{staticClass:"mt-1",domProps:{textContent:t._s(t.state.message)}}):t._e(),n("div",{staticClass:"mt-1"},[n("label",[n("setting-check",{attrs:{name:"syncScriptStatus"}}),n("span",{domProps:{textContent:t._s(t.i18n("labelSyncScriptStatus"))}})],1)])])}),[],!1,null,null,null).exports,ct={props:{name:String,disabled:Boolean,sync:{type:Boolean,default:!0}},data:()=>({value:null}),created(){var t=this,e=function(t){return Array.isArray(t)?t.join("\n"):t||""};this.value=e(o.a.get(this.name)),this.revoke=Object(w.a)(this.name,(function(n){t.value=e(n)}))},beforeDestroy(){this.revoke()},methods:{onChange(){this.sync&&o.a.set(this.name,this.value),this.$emit("change",this.value)}}},lt=Object(p.a)(ct,(function(){var t=this,e=t.$createElement;return(t._self._c||e)("textarea",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"value"}],attrs:{disabled:t.disabled},domProps:{value:t.value},on:{change:t.onChange,input:function(e){e.target.composing||(t.value=e.target.value)}}})}),[],!1,null,null,null).exports,ut={components:{SettingText:lt},methods:{onSave(){this.setTemplate(this.$refs.template.value)},onReset(){this.setTemplate("")},setTemplate(t){o.a.set("scriptTemplate",t),v({text:Object(a.k)("msgSavedScriptTemplate")})}}},dt=Object(p.a)(ut,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",[n("h3",{domProps:{textContent:t._s(t.i18n("labelScriptTemplate"))}}),n("setting-text",{ref:"template",attrs:{name:"scriptTemplate"}}),n("button",{domProps:{textContent:t._s(t.i18n("buttonSave"))},on:{click:t.onSave}}),n("button",{domProps:{textContent:t._s(t.i18n("buttonReset"))},on:{click:t.onReset}})],1)}),[],!1,null,null,null).exports,pt={components:{SettingText:lt},methods:{onSave(){o.a.set("blacklist",this.$refs.blacklist.value),v({text:Object(a.k)("msgSavedBlacklist")}),Object(a.s)({cmd:"BlacklistReset"})}}},mt=Object(p.a)(pt,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",[n("h3",{domProps:{textContent:t._s(t.i18n("labelBlacklist"))}}),n("p",[t._v("\n    "+t._s(t.i18n("descBlacklist"))+"\n    "),n("a",{attrs:{href:"https://meanOs.github.io/2017/04/15/Smart-rules-for-blacklist/#blacklist-patterns",target:"_blank"},domProps:{textContent:t._s(t.i18n("learnBlacklist"))}})]),n("setting-text",{ref:"blacklist",attrs:{name:"blacklist"}}),n("button",{domProps:{textContent:t._s(t.i18n("buttonSaveBlacklist"))},on:{click:t.onSave}})],1)}),[],!1,null,null,null).exports,ht={components:{SettingText:lt},methods:{onSave(){o.a.set("customCSS",this.$refs.css.value),v({text:Object(a.k)("msgSavedCustomCSS")})}}},vt=Object(p.a)(ht,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",[n("h3",{domProps:{textContent:t._s(t.i18n("labelCustomCSS"))}}),n("p",{domProps:{innerHTML:t._s(t.i18n("descCustomCSS"))}}),n("setting-text",{ref:"css",attrs:{name:"customCSS"}}),n("button",{domProps:{textContent:t._s(t.i18n("buttonSaveCustomCSS"))},on:{click:t.onSave}})],1)}),[],!1,null,null,null).exports,ft=[{name:"showBadge",normalize:t=>t?"total"===t?"total":"unique":""},{name:"indentUnit",key:"editor.indentUnit",normalize:t=>+t||2}],gt={showAdvanced:!1};ft.forEach((function(t){var e=t.name;gt[e]=null}));var bt={components:{Icon:f.a,VmImport:Y,VmExport:et,VmSync:rt,VmTemplate:dt,VmBlacklist:mt,VmCss:vt,SettingCheck:y.a},data:()=>gt,methods:{getUpdater(t){var e=t.key,n=t.name,s=t.normalize;return function(t,a){t!==a&&o.a.set(e||n,s(t))}}},created(){var t=this;o.a.ready((function(){ft.forEach((function(e){var n=e.name,s=e.key,i=e.normalize;gt[n]=i(o.a.get(s||n)),Object(w.a)(s,(function(t){gt[n]=t})),t.$watch(n,Object(a.d)(t.getUpdater(e),300))}))}))}},xt=(n(226),Object(p.a)(bt,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tab-settings"},[n("h1",{domProps:{textContent:t._s(t.i18n("labelSettings"))}}),n("section",[n("h3",{domProps:{textContent:t._s(t.i18n("labelGeneral"))}}),n("div",{staticClass:"mb-1"},[n("label",[n("setting-check",{attrs:{name:"autoUpdate"}}),n("span",{domProps:{textContent:t._s(t.i18n("labelAutoUpdate"))}})],1)]),n("div",{staticClass:"mb-1"},[n("label",[n("setting-check",{attrs:{name:"autoReload"}}),n("span",{domProps:{textContent:t._s(t.i18n("labelAutoReloadCurrentTab"))}})],1)]),n("div",{staticClass:"mb-1"},[n("label",[n("setting-check",{attrs:{name:"notifyUpdates"}}),n("span",{domProps:{textContent:t._s(t.i18n("labelNotifyUpdates"))}})],1)]),n("div",{staticClass:"mb-1"},[n("label",[n("span",{domProps:{textContent:t._s(t.i18n("labelBadge"))}}),n("select",{directives:[{name:"model",rawName:"v-model",value:t.showBadge,expression:"showBadge"}],on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.showBadge=e.target.multiple?n:n[0]}}},[n("option",{attrs:{value:""},domProps:{textContent:t._s(t.i18n("labelBadgeNone"))}}),n("option",{attrs:{value:"unique"},domProps:{textContent:t._s(t.i18n("labelBadgeUnique"))}}),n("option",{attrs:{value:"total"},domProps:{textContent:t._s(t.i18n("labelBadgeTotal"))}})])])])]),n("vm-import"),n("vm-export"),n("vm-sync"),n("div",{staticClass:"show-advanced"},[n("button",{on:{click:function(e){t.showAdvanced=!t.showAdvanced}}},[n("span",{domProps:{textContent:t._s(t.i18n("labelAdvanced"))}}),n("icon",{class:{rotate:t.showAdvanced},attrs:{name:"arrow"}})],1)]),n("div",{directives:[{name:"show",rawName:"v-show",value:t.showAdvanced,expression:"showAdvanced"}]},[n("section",[n("h3",{domProps:{textContent:t._s(t.i18n("labelEditor"))}}),n("div",{staticClass:"mb-1"},[n("label",[n("setting-check",{attrs:{name:"editor.lineWrapping"}}),n("span",{domProps:{textContent:t._s(t.i18n("labelLineWrapping"))}})],1)]),n("div",{staticClass:"mb-1"},[n("label",[n("span",{staticClass:"mr-1",domProps:{textContent:t._s(t.i18n("labelIndentUnit"))}}),n("input",{directives:[{name:"model",rawName:"v-model",value:t.indentUnit,expression:"indentUnit"}],staticClass:"w-1",attrs:{type:"number",min:"1"},domProps:{value:t.indentUnit},on:{input:function(e){e.target.composing||(t.indentUnit=e.target.value)}}})])])]),n("vm-template"),n("vm-blacklist"),n("vm-css")],1)],1)}),[],!1,null,null,null).exports),Ct=n(37),_t={ready:!1,optInConfirmed:!1,optInAccepted:!1};function yt(t){_t.optInConfirmed=!0,_t.optInAccepted=t,Object(Ct.b)(t)}Object(Ct.a)().then((function(t){_t.optInConfirmed=t.confirmed,_t.optInAccepted=t.accepted,_t.ready=!0}));var wt={data:()=>_t,methods:{acceptOptIn(){yt(!0)},rejectOptIn(){yt(!1)},onChange(t){yt(t.target.checked)}}},kt=Object(p.a)(wt,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"show",rawName:"v-show",value:t.ready,expression:"ready"}],staticClass:"tab-privacy-settings"},[n("h1",{domProps:{textContent:t._s(t.i18n("Privacy Settings"))}}),n("div",{directives:[{name:"show",rawName:"v-show",value:t.optInConfirmed,expression:"optInConfirmed"}]},[n("input",{attrs:{id:"optInAccepted",type:"checkbox"},domProps:{checked:t.optInAccepted},on:{change:t.onChange}}),n("label",{attrs:{for:"optInAccepted"}},[t._v("Allow anonymous processing of your IP address")])]),n("div",{directives:[{name:"show",rawName:"v-show",value:!t.optInConfirmed,expression:"!optInConfirmed"}]},[n("div",[n("p",[t._v("\n        This extension does not collect any of your personal data.\n      ")]),t._m(0),n("p",[t._v("\n        Technically each request contains your IP address, which may\n        be treated as personal data. We don't collect and process this data in\n        any way, but to be compliant with the browser's privacy policy we need\n        your explicit permission to collect IP address if we need it in the\n        future.\n      ")]),n("p",[t._v('\n        So, if you grant us a permission to process your IP address (without\n        ever sharing it with third parties) then click "Accept" below. Otherwise,\n        click "Reject" (you can change your opinion any time later):\n      ')]),n("p",[n("button",{domProps:{textContent:t._s(t.i18n("Accept"))},on:{click:t.acceptOptIn}}),n("button",{attrs:{autofocus:"true"},domProps:{textContent:t._s(t.i18n("Reject"))},on:{click:t.rejectOptIn}})]),n("hr"),t._m(1)])])])}),[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("p",[t._v("\n        However, it will periodically send requests to our server to update\n        userscript recommendations. This request contains such anonymous data:\n        "),n("ul",[n("li",[t._v("vendor of the browser you use")]),n("li",[t._v("your preferred language")]),n("li",[t._v("the version of the extension")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("p",[t._v("\n        You can find more info here:\n        "),n("a",{attrs:{target:"_blank",href:"https://addons.mozilla.org/en-US/firefox/addon/meanOs/privacy/"}},[t._v("\n          Privacy policy\n        ")])])}],!1,null,null,null).exports,St={version:browser.runtime.getManifest().version,language:navigator.language},Pt={data:()=>St},Ot={scripts:z,settings:xt,privacySettings:kt,about:Object(p.a)(Pt,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tab-about"},[n("h1",[n("span",{staticClass:"mr-1",domProps:{textContent:t._s(t.i18n("labelAbout"))}}),n("small",{domProps:{textContent:t._s("v"+t.version)}})]),n("p",{staticClass:"mb-2",domProps:{textContent:t._s(t.i18n("extDescription"))}}),n("div",{staticClass:"mb-1"},[n("label",{domProps:{textContent:t._s(t.i18n("labelRelated"))}}),n("a",{attrs:{href:"https://github.com/obeyi",target:"_blank"}},[t._v("Source code")]),t._v("\n    | "),n("a",{attrs:{href:"https://obeyi.com/#privacy",target:"_blank"}},[t._v("Privacy policy")])]),n("div",{staticClass:"mb-1"},[n("label",{domProps:{textContent:t._s(t.i18n("labelAuthor"))}}),n("span",{domProps:{innerHTML:t._s(t.i18n("anchorAuthor"))}}),t._v(" | "),n("a",{attrs:{href:"https://meanOs.github.io/donate/",target:"_blank"},domProps:{textContent:t._s(t.i18n("labelDonate"))}}),n("span",{staticClass:"text-red"},[t._v(" ♥")])]),n("div",{staticClass:"mb-1"},[n("label",{domProps:{textContent:t._s(t.i18n("labelTranslator"))}}),n("span",{domProps:{innerHTML:t._s(t.i18n("anchorTranslator"))}})]),n("div",{staticClass:"mb-1"},[n("label",{domProps:{textContent:t._s(t.i18n("labelCurrentLang"))}}),n("span",{staticClass:"text-green",domProps:{textContent:t._s(t.language)}}),t._v(" |\n    "),n("a",{attrs:{href:"https://meanOs.github.io/localization/",target:"_blank"},domProps:{textContent:t._s(t.i18n("labelHelpTranslate"))}})])])}),[],!1,null,null,null).exports},Ut={components:{Icon:f.a},data:()=>({aside:!1,store:h}),computed:{tab(){var t=this.store.route.paths[0];return Ot[t]||(t="scripts"),t},tabComponent(){return Ot[this.tab]}}},jt=(n(227),Object(p.a)(Ut,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"page-options flex h-100"},[n("aside",{class:{"show-aside":t.aside}},[n("div",{staticClass:"aside-content"},[n("img",{attrs:{src:"/public/images/icon-128x128.png"}}),n("h1",{domProps:{textContent:t._s(t.i18n("extName"))}}),n("div",{staticClass:"aside-menu"},[n("a",{class:{active:"scripts"===t.tab},attrs:{href:"#scripts"},domProps:{textContent:t._s(t.i18n("sideMenuInstalled"))}}),n("a",{class:{active:"settings"===t.tab},attrs:{href:"#settings"},domProps:{textContent:t._s(t.i18n("sideMenuSettings"))}}),n("a",{class:{active:"privacySettings"===t.tab},attrs:{href:"#privacySettings"},domProps:{textContent:t._s(t.i18n("Privacy Settings"))}}),n("a",{class:{active:"about"===t.tab},attrs:{href:"#about"},domProps:{textContent:t._s(t.i18n("sideMenuAbout"))}})]),n("div",{staticClass:"aside-toggle visible-sm",on:{click:function(e){t.aside=!t.aside}}},[n("icon",{attrs:{name:"arrow"}})],1)])]),n(t.tabComponent,{tag:"component",staticClass:"tab flex-auto"})],1)}),[],!1,null,null,null).exports);function Lt(t){var e=t.meta||{},n=Object(a.h)(e,"name"),s=[e.name,n,e.description,Object(a.h)(e,"description"),t.custom.name,t.custom.description].filter(Boolean).join("\n").toLowerCase(),o=t.custom.name||n,i=o.toLowerCase();t.$cache={search:s,name:o,lowerName:i}}function Et(t){Object(a.s)({cmd:"GetData",data:t}).then((function(t){var e=h.cache||{};h.cache=null,["cache","scripts","sync"].forEach((function(e){s.default.set(h,e,t[e])})),h.scripts&&h.scripts.forEach(Lt),h.cache&&Object.keys(h.cache).forEach((function(t){var n=h.cache[t];e[t]?(h.cache[t]=e[t],delete e[t]):h.cache[t]=Object(a.c)(n,{defaultType:"image/png"})})),Object.values(e).forEach((function(t){URL.revokeObjectURL(t)})),h.loading=!1}))}s.default.prototype.i18n=a.k,Object.assign(h,{loading:!1,cache:{},scripts:[],sync:[],filteredScripts:[]}),zip.workerScriptsPath="/public/lib/zip.js/",document.title=Object(a.k)("extName"),h.loading=!0,Et(!0),Object.assign(i.a,{ScriptsUpdated(){Et()},UpdateSync(t){h.sync=t},AddScript(t){var e=t.update;e.message="",Lt(e),h.scripts.push(e)},UpdateScript(t){if(t){var e=h.scripts.findIndex((function(e){return e.props.id===t.where.id}));if(e>=0){var n=Object.assign({},h.scripts[e],t.update);s.default.set(h.scripts,e,n),Lt(n)}}},RemoveScript(t){var e=h.scripts.findIndex((function(e){return e.props.id===t}));e>=0&&h.scripts.splice(e,1)}}),o.a.ready((function(){var t=document.createElement("div");document.body.appendChild(t),new s.default({render:function(t){return t(jt)}}).$mount(t)}))},54:function(t,e,n){"use strict";function s(t){return t&&"object"==typeof t&&"default"in t?t.default:t}var a=s(n(184)),o=s(n(18));function i(t,e,n,s,a,o,i,r,c,l){"boolean"!=typeof i&&(c=r,r=i,i=!1);const u="function"==typeof n?n.options:n;let d;if(t&&t.render&&(u.render=t.render,u.staticRenderFns=t.staticRenderFns,u._compiled=!0,a&&(u.functional=!0)),s&&(u._scopeId=s),o?(d=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),e&&e.call(this,c(t)),t&&t._registeredComponents&&t._registeredComponents.add(o)},u._ssrRegister=d):e&&(d=i?function(t){e.call(this,l(t,this.$root.$options.shadowRoot))}:function(t){e.call(this,r(t))}),d)if(u.functional){const t=u.render;u.render=function(e,n){return d.call(n),t(e,n)}}else{const t=u.beforeCreate;u.beforeCreate=t?[].concat(t,d):[d]}return n}const r=i({render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("transition",{attrs:{name:t.transition,appear:""},on:{"after-leave":t.onAfterLeave}},[t.visible?n("div",{class:"vl-modal "+t.modalClass},[t.backdrop?n("div",{class:"vl-modal-backdrop "+t.backdropClass,on:{click:t.onBackdropClick}}):t._e(),t._v(" "),t._t("default")],2):t._e()])],1)},staticRenderFns:[]},undefined,{props:{modalClass:{type:String,default:""},backdropClass:{type:String,default:""},transition:{type:String,default:""},visible:{type:Boolean,default:!1},backdrop:{type:[Object,Boolean],default:function(){return{close:!0}}}},methods:{onBackdropClick:function(){(!0===this.backdrop||this.backdrop.close)&&this.$emit("close",{source:"backdrop"})},onAfterLeave:function(){this.$emit("after-leave")}}},undefined,false,undefined,!1,void 0,void 0,void 0);function c(t,e){var n=a({},e,{visible:!0}),s={close:i,"after-leave":function(){if(o){var t=o.$el;t.parentNode.removeChild(t),o.$destroy(),o=null}}},o=new r.Vue({data:n,render:function(e){var a="function"==typeof t?t(e):t;return e(r,{props:n,on:s},[a])}}).$mount();return document.body.appendChild(o.$el),{close:i};function i(){n.visible=!1}}r.Vue=o,r.install=function(t){r.Vue=t,t.prototype.$modal=c,t.component("vl-modal",r)},r.show=c,t.exports=r},97:function(t,e,n){},98:function(t,e,n){}});